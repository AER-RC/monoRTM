
Version 5.0 

The code was significantly restructured, new capabilities were added, and the spectroscopy was upgraded. 

* Restructuring (K. Cady-Pereira, G. Uymin, A. Lipton)

   - All routines except tips_2003.f are now f90.

   - The code's spectroscopic line input structure and atmospheric profiling
     code were made more consistent with LBLRTM. Line parameters are now read
     from a binary TAPE3 file produced with LNFL, as in LBLRTM.

   - The code to read in and store the spectroscopic data was removed from modm
     and is in a separate module: lnfl_mod.f90

   - The RT codes are also in a new module: RTM mono.f

   - Physical constants are all declared in one module, PhysConstants.f90, which
     also provides routines to access the values; geophysical parameters in
     another similar module, PlanetEarth.f90.

* Additional capabilities

   - The capability to utilize a speed-dependent Voigt line shape has been added
     using the approach of Boone et al. (2007; 2011) (M. Alvarado). 

   - The spectral region about line center in which the detailed Humlicek (1982)
     method is used to compute the line shape has been extended to provide
     greater accuracy (M. Alvarado, E. Mlawer, G. Villanueva).

   - The method to compute path lengths in the code√ïs atmospheric module was
     changed to provide greater stability for cases with exceptionally high
     rates of change of refractive index with height (M. Alvarado, E. Mlawer, D.
     Turner, N. Miller)

   - A number of new input and output options, including optional netcdf output
     with spectral layer optical depths, have been added. (K. Cady-Pereira, D.
     Berthiaume,???)

   - Mixing ratio inputs are now allowed for IATM=0 (K. Cady-Pereira, J. Delamere)

   - The capability to utilize available line broadening coefficients (width,
     temperature dependence, pressure shift) that are specific to a given pair
of species was added (K. Cady-Pereira, E. Mlawer, M. Alvarado).

   - A bug related to foreign broadening of oxygen transitions was fixed (E.
     Mlawer, M. Alvarado, K. Cady-Pereira).

   - A bug related to the use of the continuum in MonoRTM for near-IR cases was
     fixed (K. Cady-Pereira, M. Alvarado).

   - The incoming half-widths for N2 and O2, which are defined for broadening by
     air, are now corrected to reflect broadening  by O2 and N2, respectively.

* Spectroscopy 

   - The default microwave line parameter files ,
     spectral_lines.dat.0_55.v5.0_slow and spectral_lines.dat.0_55.v5.0_fast,
     now have a direct correspondence to the full AER linelist., whose current
     version is aer_v_3.3 (M. Alvarado, K. Cady-Pereira, E. Mlawer).

   - Numerous lines were added to the default microwave line files so that the
     calculational accuracy at any frequency between 0 and 899.4 GHz (0-30 cm-1)
     with respect to the full line list aer_v_3.3 is:

     # for spectral_lines.dat.0_55.v5.0_slow (corresponds to ISPD=0 in MonoRTM
       v4.2 and older): 0.1 K for upwelling, 0.2 K for downwelling  

     # for spectral_lines.dat.0_55.v5.0_fast (corresponds to ISPD=1 in MonoRTM
       v4.2 and older): 0.5 K for upwelling, 1.0 K for downwelling 
          (M. Alvarado, E. Mlawer, K. Cady-Pereira) 

   - Line parameters were taken from HITRAN 2012 with the exceptions noted below.

      1. 60 GHz O2 lines and 120 Ghz O2 line from Tretyakov et al. (2005), as
         implemented in MonoRTM v4.2.                                                                   

      2. 0 cm-1 "Debye line" for O2 same as in MonoRTM v4.2, all other O2 lines
         below 1.497951 cm-1 removed.                                                        

      3. The intensities for the H2O lines at 0.7417 cm-1 (22.233 GHz), 6.1145
         cm-1 (183.3 GHz), 10.84 cm-1 (325 GHz) and 12.68 cm-1 (380 GHz) are based on the
         work of S. A. Clough (1973) and are the same as in MonoRTM v4.2.

      4. The foreign widths of the 22 and 183 GHz water vapor lines were
         rederived based on HITRAN 2012 line parameters using the approach of Payne et
         al. (2009).  The temperature dependence parameters for these lines were adjusted
         from their HITRAN 2012 values to provide better agreement with calculations by
         Gamache (V. Payne, B. Gamache, E. Mlawer).

   - Broadening parameters were implemented for the following pairs of molecules:

      1. Oxygen transitions broadened by water vapor based on Drouin et al.
         (2013) (E. Mlawer, K. Cady-Pereira)

      2. Carbon dioxide transitions broadened by water vapor based on Sung (2009) (K. Cady-Pereira).

      3. Water vapor transitions broadened by carbon dioxide based on
         calculations by R. Gamache of U. Mass. Lowell (K. Cady-Pereira).

      4. Carbon dioxide transitions broadened by carbon dioxide based on
         calculations by R. Gamache of U. Mass. Lowell (K. Cady-Pereira).

   - The continuum was updated to MT_CKD_2.5.  

   - Speed dependent parameters were implemented for CO2 transitions in the
     bands 68<-1 and 71<-1 (i.e., 30012<-00001 and 30013<-00001) following Devi
         et al. (2007a,b) (M. Alvarado).

Karen Cady-Pereira, AER, December 2013

****************************************************************
Version 4.3

This version of MonoRTM includes the MT_CKD 2.5.2 continuum (updated from
 MT_CKD 2.4). This continuum update includes a bug fix to the N2 continuum.

Note that versions 4.0 onwards of MonoRTM represent a significant update 
to previous versions where the version number begins with 3 or below.
The code has been updated to allow the use of MonoRTM beyond the
microwave region (provided an appropriate spectral line file is used).
A number of changes were also made in order to make the input 
more consistent with that of LBLRTM.  Note that the INP option is no 
longer available.  The INP=1 option can be reproduced by setting IATM=1.
The INP=3 option may be reproduced by setting IATM=0. The INP=2 option 
is no longer available.  Users wishing to run multiple profiles may now 
do so by providing multiple profiles in the MONORTM.IN (for IATM=1) or
MONORTM_PROF.IN (for IATM=0) files. 

Vivienne Payne, AER Inc., March 2011


****************************************************************
*
*      M O N O R T M       D I R E C T O R Y
*
*
*      Note: Since efforts are constantly being made
*      to improve MonoRTM (at the spectroscopic level, the 
*      line shape theory, the continuum, the radiative transfer
*      model, line coupling, etc,..), the user is therefore strongly 
*      advised to register to the MonoRTM mailing list. For this, 
*      simply send an email to cadyp@aer.com.
*      You will be notified each time there is an update.
****************************************************************

This is MONORTM directory. It contains several sub-directories described
briefly below:

CVS    -> For version control. Do not edit.
README -> This file.
build  -> Contains makefiles for MonoRTM for different platforms
run    -> Contains files required to run MonoRTM.
	  .  run_monortm_example is a script to run some examples
	  .  TAPE3_spectral_lines.dat.0_55.v5.0_slow  contains the spectral line information
	    - (Note that if you wish to run a calculation for a spectral range 
              outside the wavenumber range of the spectral line files supplied 
	      in the examples, you can create a line file using MonoLNFL, which is
              contained in this release package). 
	  -> subdirectory run/in contains sample input files
	     '_dn' denotes sample input files for downwelling radiance calculations
	     '_up' denotes sample input files for upwelling radiance calculations
		. MONORTM.IN         : input compatible with lblrtm (ex-TAPE5). IATM=1
                                       IDL code to generate profiles in TAPE5 format 
		                       from ARM netCDF radiosonde files is available 
                                       in the idl sub-directory  
	        . MONORTM_PROF.IN    : contains layer data, IATM=0 (this is a copy of TAPE7
                                       which is generated by a run where IATM=1
	  -> subdirectory run/out will hold the output from MonoRTM
		. MONORTM.OUT	     : IDL code to read this file and to make plots is 
				       available in idl sub-directory.
	        . MONORTM.LOG (if LBLATM is ON) - TAPE6 file
	        . TAPE7 (if LBLATM is ON)      
src -> contains all source files needed by MonoRTM.
doc -> detailed instructions manual about MonoRTM, in ascii format. 
idl -> tool for creating monortm input from ARM sonde files.

HOW TO RUN MONORTM:
-------------------
Assuming you are in the main directory.

. Compilation:
  > cd build
  > make -f make_monortm OPTION, where the values for OPTION are listed in makefile.common
  > cd ..

. Running (to generate example output):
  > cd run
  > run_monortm_examples
 (Note that you may have to modify the executable name in 
 "run_monortm_examples" to match the name of the executable that you 
  have created.)


. Numerical check
  > cd run/out
  > diff MONORTM.OUT aer_MONORTM.OUT

HOW TO TAILOR MONORTM TO SPECIFIC NEEDS:
----------------------------------------
MONORTM is a driver program that calls the core module called the Monochromatic 
Optical Depth Model (MODM). 
The inputs to MODM could be modified inside monortm.f90 directly or through the input
file MONORTM.IN (same type of format as LBLRTM's TAPE5), see instructions for more details.
MonoRTM is a forward model. MonoRTM is designed to be very flexible. We can either use 
it as a black box and control everything from the MONORTM.IN input file, or one can modify 
the code itself and recompile it. In the latter, it is structured in such a way that the 
changes should always be done in "monortm.f90" (the driver program). The other auxillary 
files (monortm_sub.f90, modm.f90, lblatm.f90, lblrtm_sub.f, tips_2003.f and 
 isotope.dat) should normally not be touched, except in rare situations. In case
there is an update in the continuum calculations a new "contnm.f90" module will be
generated and sent to the users (or made available on the WEB/ftp site). 

The core of MonoRTM is the computation of the optical depths. It is designed as a
subroutine for flexibility and could be easily plugged in a different radiative
transfer model if needed.


OUTPUTS OF MONORTM:
-------------------
The records stored in MONORTM.OUT are the following:
NPR	: 	Profile index used (not necessarily in order).
FREQ	: 	Frequency in GHz (or wavenumbers, for wavenumbers greater than 100 cm-1)
BT(I)	: 	Brightness temperature in Kelvin
TMR(I)  :       Mean radiating temperature (K)
RAD(I)	: 	Radiance (W/(cm^2 ster cm^-1))
TRTOT(I): 	Total transmittance (no unit: between 0 and 1)
WVCOLMN	: 	Integrated water vapor amount along the optical path in cm
CLWCOLMN: 	Integrated cloud liquid water along the optical path in mm
TMPSFC	: 	Surface/target temperature in K
EMISS(I): 	Surface/target emissivity (no unit, between 0 and 1)
REFLC(I): 	Surface/target Reflectivity (no unit , between 0 and 1)
ANGLE	: 	Angle in degrees
OTOT	: 	Total column-integrated optical depth due to all species
OTOT_*	: 	Total column-integrated optical depth by molecules with line data
ODXSEC	: 	Total column-integrated optical depth due to all cross-section molecules

NETCDF OUTPUT
-------------------
If MONORTM is compiled with the nectdf option on (see README.build_instructions in the build directory)
then a nectdf file named MONORTM.xxxxx.nc (where xxxxx is the profile number) will be created. This file will
contain all the variables above along with the layer optical depths and the layer optical depths by molecule.


QUESTIONS:
----------
Any comments or questions should be forwarded to Karen Cady-Pereira (kcadyper@aer.com)

AER , Radiation and Climate Group
131 Hartwell Avenue
Lexington, MA 02421
USA
Tel: 1 781 761 2216
Fax: 1 781 761 2299



